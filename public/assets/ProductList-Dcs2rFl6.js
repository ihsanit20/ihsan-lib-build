import{p as B,r as l,e as C,B as F,c as r,a as e,g as c,h as y,F as h,x as S,t as n,i as D,l as A,o as d,L as V,j as p}from"./index-CocE4riB.js";import{_ as M}from"./PhotoModal-LwPHB5Zl.js";const O={class:"my-container space-y-4"},U={class:"flex items-center justify-between gap-2"},E={class:"overflow-x-auto bg-white shadow rounded-lg"},R={class:"table-auto w-full border-collapse border border-gray-200"},T={key:0},$={colspan:"6"},q={key:1},z={class:"px-4 py-3 border border-gray-200"},G={class:"flex justify-center md:justify-start"},H=["onClick","src"],I={class:"px-4 py-3 border border-gray-200"},J={class:"md:flex gap-2 text-sm"},K={class:"font-medium"},Q={class:"font-medium"},W={class:"px-4 py-3 border border-gray-200"},X={class:"min-w-max"},Y={class:"px-4 py-3 border border-gray-200"},Z={class:"px-4 py-3 border border-gray-200"},ee={class:"min-w-max"},te={class:"px-4 py-3 border border-gray-200"},se={class:"flex justify-center gap-4"},oe={key:0,class:"mt-4 text-red-600 text-sm text-center"},ne={__name:"ProductList",setup(ae){const u=B(),b=l(null),f=l(null),v=l(!0),_=l(!1),x=l(null),m=l(null),g=l(!1),w=l(!1);C(async()=>{var o,t;try{await u.fetchProducts()}catch(i){b.value=((t=(o=i.response)==null?void 0:o.data)==null?void 0:t.message)||"Failed to fetch products"}finally{v.value=!1}});const P=F(()=>Array.isArray(u.products)?[...u.products].sort((o,t)=>new Date(t.created_at)-new Date(o.created_at)):[]),L=o=>{f.value=o,x.value=o.photo,_.value=!0},k=()=>{_.value=!1,m.value=null},N=o=>{m.value=o},j=async()=>{if(!(!m.value||!f.value))try{g.value=!0,await u.uploadPhoto(f.value.id,m.value),await u.fetchProducts(),w.value=!0,setTimeout(()=>{k(),g.value=!1,w.value=!1},1500)}catch(o){console.error("Failed to upload photo:",o)}finally{g.value=!1}};return(o,t)=>{const i=A("RouterLink");return d(),r(h,null,[e("div",O,[e("div",U,[t[1]||(t[1]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"পণ্য তালিকা",-1)),c(i,{to:{name:"ProductAdd"},class:"btn-2"},{default:y(()=>t[0]||(t[0]=[e("span",{class:"hidden md:flex"},"নতুন বই",-1),e("i",{class:"far fa-plus"},null,-1)])),_:1})]),e("div",E,[e("table",R,[t[9]||(t[9]=e("thead",null,[e("tr",{class:"bg-gray-200 text-left text-gray-700 uppercase text-sm tracking-wider"},[e("th",{class:"px-4 py-3 border border-gray-200"},"ছবি"),e("th",{class:"px-4 py-3 border border-gray-200"},"পণ্যের নাম ও দাম"),e("th",{class:"px-4 py-3 border border-gray-200"},"লেখক/অনুবাদক"),e("th",{class:"px-4 py-3 border border-gray-200"},"ক্যাটাগরি"),e("th",{class:"px-4 py-3 border border-gray-200 text-center"},"স্টক"),e("th",{class:"px-4 py-3 border border-gray-200 text-center"},"একশন")])],-1)),e("tbody",null,[v.value?(d(),r("tr",T,[e("td",$,[c(V,{class:"shadow-none"})])])):P.value.length===0?(d(),r("tr",q,t[2]||(t[2]=[e("td",{colspan:"6",class:"text-center py-6 text-gray-500"}," কোন প্রডাক্ট পাওয়া যায়নি। ",-1)]))):(d(!0),r(h,{key:2},S(P.value,s=>(d(),r("tr",{key:s.id,class:"hover:bg-gray-50 transition ease-in-out"},[e("td",z,[e("div",G,[e("img",{onClick:a=>L(s),src:s.photo,alt:"Photo",class:"w-12 h-16 rounded object-cover cursor-pointer"},null,8,H)])]),e("td",I,[c(i,{to:{name:"ProductShow",params:{id:s.id}},class:"title-md line-clamp-1"},{default:y(()=>[p(n(s.name),1)]),_:2},1032,["to"]),e("div",J,[e("p",K,[t[3]||(t[3]=e("b",null,"খুচরা মূল্য:",-1)),p(" "+n(Number(s.mrp).toLocaleString("bn-BD"))+" টাকা ",1)]),e("p",Q,[t[4]||(t[4]=e("b",null,"বিক্রয় মূল্য:",-1)),p(" "+n(Number(s.selling_price).toLocaleString("bn-BD"))+" টাকা ",1)])])]),e("td",W,[e("div",X,[e("p",null,[t[5]||(t[5]=e("strong",null,"লেখক:",-1)),p(" "+n(s.authors.filter(a=>a.role==="author").map(a=>a.name).join(", ")||"N/A"),1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"অনুবাদক:",-1)),p(" "+n(s.authors.filter(a=>a.role==="translator").map(a=>a.name).join(", ")||"N/A"),1)])])]),e("td",Y,[e("div",null,[(d(!0),r(h,null,S(s.categories,a=>(d(),r("p",{key:a,class:"min-w-max"},n(a),1))),128))])]),e("td",Z,[e("p",ee,n(Number(s.available_stock).toLocaleString("bn-BD"))+" টি ",1)]),e("td",te,[e("div",se,[c(i,{to:{name:"ProductShow",params:{id:s.id}},class:"btn-icon"},{default:y(()=>t[7]||(t[7]=[e("i",{class:"fad fa-eye"},null,-1)])),_:2},1032,["to"]),c(i,{to:{name:"ProductEdit",params:{id:s.id}},class:"btn-icon"},{default:y(()=>t[8]||(t[8]=[e("i",{class:"fad fa-edit"},null,-1)])),_:2},1032,["to"])])])]))),128))])])]),b.value?(d(),r("div",oe,n(b.value),1)):D("",!0)]),c(M,{imageSrc:x.value,isOpen:_.value,onClose:k,onFileSelected:N,onUploadPhoto:j},null,8,["imageSrc","isOpen"])],64)}}};export{ne as default};
