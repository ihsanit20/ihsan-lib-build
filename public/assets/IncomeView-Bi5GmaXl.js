import{_ as B}from"./HeaderWithButtons-BYuVYrIe.js";import{b as h,L as D}from"./index-O5G5k-zH.js";import{d as N,r as g,N as U,k,c as u,o as i,b as e,J as M,a as I,l as b,s as _,K as F,F as w,h as S,t as x,u as y,q as L,x as E,e as q}from"./vue-DFkF7ryY.js";import{u as H}from"./income-expense-head-DLC9WL39.js";import"./vendor-BtuGy7By.js";const V=N("income",()=>{const m=g([]),c=g(null),l=g(!1),n=g(null);return{incomes:m,income:c,loading:l,error:n,fetchIncomes:async(t={})=>{var o,d;l.value=!0,n.value=null;try{const a=await h.get("/incomes",{params:t});m.value=a.data}catch(a){n.value=((d=(o=a.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to fetch incomes"}finally{l.value=!1}},fetchIncome:async t=>{var o,d;l.value=!0,n.value=null;try{const a=await h.get(`/incomes/${t}`);c.value=a.data}catch(a){n.value=((d=(o=a.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to fetch income"}finally{l.value=!1}},createIncome:async t=>{var o,d;l.value=!0,n.value=null;try{const a=await h.post("/incomes",t);m.value.push(a.data)}catch(a){throw n.value=((d=(o=a.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to create income",a}finally{l.value=!1}},updateIncome:async(t,o)=>{var d,a;l.value=!0,n.value=null;try{const $=await h.put(`/incomes/${t}`,o),C=m.value.findIndex(O=>O.id===t);C!==-1&&(m.value[C]=$.data)}catch($){throw n.value=((a=(d=$.response)==null?void 0:d.data)==null?void 0:a.message)||"Failed to update income",$}finally{l.value=!1}},deleteIncome:async t=>{var o,d;l.value=!0,n.value=null;try{await h.delete(`/incomes/${t}`),m.value=m.value.filter(a=>a.id!==t)}catch(a){throw n.value=((d=(o=a.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to delete income",a}finally{l.value=!1}}}}),j={class:"modal-bg"},A={class:"modal-card"},z={class:"grid md:grid-cols-2 gap-4"},J={class:"col-span-full"},K=["value"],T={class:"col-span-full"},G={class:"mt-4 text-red-600 text-sm text-center"},P={class:"flex justify-end space-x-4"},Q={__name:"AddIncome",emits:["close","saved"],setup(m,{emit:c}){const l=c,n=U({date:"",income_expense_head_id:"",amount:"",description:""}),r=H(),p=V(),v=async()=>{await p.createIncome(n),l("saved"),l("close"),p.fetchIncomes()};return k(async()=>{r.fetchIncomeExpenseHeads({type:"Income"})}),(f,s)=>(i(),u("div",j,[e("div",A,[s[13]||(s[13]=e("h2",{class:"text-2xl font-bold text-center"},"নতুন আয় যুক্ত করুন",-1)),s[14]||(s[14]=e("hr",{class:"my-2"},null,-1)),e("form",{onSubmit:M(v,["prevent"]),class:"space-y-4"},[e("div",z,[e("div",null,[s[5]||(s[5]=e("label",null,"তারিখ",-1)),b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>n.date=t),type:"date",class:"w-full p-2 border rounded",required:""},null,512),[[_,n.date]])]),e("div",null,[s[6]||(s[6]=e("label",null,"পরিমাণ",-1)),b(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>n.amount=t),type:"number",class:"w-full p-2 border rounded text-right",required:""},null,512),[[_,n.amount]])]),e("div",J,[s[8]||(s[8]=e("label",null,"আয়ের খাত",-1)),b(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>n.income_expense_head_id=t),class:"w-full p-2 border rounded",required:""},[s[7]||(s[7]=e("option",{value:""},"- আয়ের খাত নির্বাচন করুন -",-1)),(i(!0),u(w,null,S(y(r).incomeExpenseHeads,t=>(i(),u("option",{key:t.id,value:t.id},x(t.name),9,K))),128))],512),[[F,n.income_expense_head_id]])]),e("div",T,[s[9]||(s[9]=e("label",null,"বিবরণ",-1)),b(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>n.description=t),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[_,n.description]])])]),y(p).error?(i(),u(w,{key:0},[s[10]||(s[10]=e("hr",{class:"my-2"},null,-1)),e("div",G,x(y(p).error),1)],64)):I("",!0),s[12]||(s[12]=e("hr",{class:"my-2"},null,-1)),e("div",P,[s[11]||(s[11]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},"Save",-1)),e("button",{type:"button",onClick:s[4]||(s[4]=t=>l("close")),class:"bg-gray-500 text-white px-4 py-2 rounded"}," Cancel ")])],32)])]))}},R={class:"modal-bg"},W={class:"modal-card"},X={class:"grid md:grid-cols-2 gap-4"},Y={class:"col-span-full"},Z=["value"],ee={class:"col-span-full"},te={class:"mt-4 text-red-600 text-sm text-center"},se={class:"flex justify-end space-x-4"},oe={__name:"EditIncome",props:{income:Object},emits:["close","updated"],setup(m,{emit:c}){const l=c,n=m,r=U({date:"",income_expense_head_id:"",amount:"",description:""}),p=V(),v=H();L(()=>n.income,s=>{r.date=s.date||"",r.income_expense_head_id=s.income_expense_head_id||"",r.amount=s.amount||"",r.description=s.description||""},{immediate:!0});const f=async()=>{await p.updateIncome(n.income.id,r),l("updated"),l("close"),p.fetchIncomes()};return k(async()=>{v.fetchIncomeExpenseHeads({type:"Income"})}),(s,t)=>(i(),u("div",R,[e("div",W,[t[13]||(t[13]=e("h2",{class:"text-2xl font-bold text-center"},"আয় সম্পাদন করুন",-1)),t[14]||(t[14]=e("hr",{class:"my-2"},null,-1)),e("form",{onSubmit:M(f,["prevent"]),class:"space-y-4"},[e("div",X,[e("div",null,[t[5]||(t[5]=e("label",null,"তারিখ",-1)),b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>r.date=o),type:"date",class:"w-full p-2 border rounded",required:""},null,512),[[_,r.date]])]),e("div",null,[t[6]||(t[6]=e("label",null,"পরিমাণ",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.amount=o),type:"number",class:"w-full p-2 border rounded text-right",required:""},null,512),[[_,r.amount]])]),e("div",Y,[t[8]||(t[8]=e("label",null,"আয়ের খাত",-1)),b(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.income_expense_head_id=o),class:"w-full p-2 border rounded",required:""},[t[7]||(t[7]=e("option",{value:""},"- আয়ের খাত নির্বাচন করুন -",-1)),(i(!0),u(w,null,S(y(v).incomeExpenseHeads,o=>(i(),u("option",{key:o.id,value:o.id},x(o.name),9,Z))),128))],512),[[F,r.income_expense_head_id]])]),e("div",ee,[t[9]||(t[9]=e("label",null,"বিবরণ",-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r.description=o),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[_,r.description]])])]),y(p).error?(i(),u(w,{key:0},[t[10]||(t[10]=e("hr",{class:"my-2"},null,-1)),e("div",te,x(y(p).error),1)],64)):I("",!0),t[12]||(t[12]=e("hr",{class:"my-2"},null,-1)),e("div",se,[t[11]||(t[11]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},"Update",-1)),e("button",{type:"button",onClick:t[4]||(t[4]=o=>l("close")),class:"bg-gray-500 text-white px-4 py-2 rounded"}," Cancel ")])],32)])]))}},ne={class:"my-container space-y-4"},le={class:"overflow-x-auto bg-white shadow rounded-lg"},ae={class:"table-auto w-full border-collapse border border-gray-200"},re={key:0},de={colspan:"7",class:"text-center py-6"},ie={key:1},ue={class:"px-4 py-3 border border-gray-200 text-center"},ce={class:"px-4 py-3 border border-gray-200 text-center"},pe={class:"px-4 py-3 border border-gray-200 text-center"},me={class:"px-4 py-3 border border-gray-200 text-left"},ye={class:"px-4 py-3 border border-gray-200 text-center"},xe={class:"px-4 py-3 border border-gray-200 text-center"},ve=["onClick"],be={key:0,class:"mt-4 text-red-600 text-sm text-center"},Ie={__name:"IncomeView",setup(m){const c=V(),l=g(null),n=g(!1);k(async()=>{await c.fetchIncomes()});const r=f=>{l.value=f,n.value=!0},p=()=>{l.value=null,n.value=!0},v=()=>{n.value=!1,l.value=null};return(f,s)=>{var t;return i(),u(w,null,[e("div",ne,[q(B,{title:"আয়ের তালিকা",onAdd:p}),e("div",le,[e("table",ae,[s[1]||(s[1]=e("thead",null,[e("tr",{class:"bg-gray-200 text-left text-gray-700 text-sm tracking-wider"},[e("th",{class:"px-4 py-3 border text-center"},"#"),e("th",{class:"px-4 py-3 border text-center"},"তারিখ"),e("th",{class:"px-4 py-3 border text-center"},"খাত"),e("th",{class:"px-4 py-3 border"},"বিবরণ"),e("th",{class:"px-4 py-3 border text-center"},"পরিমাণ"),e("th",{class:"px-4 py-3 border text-center"},"একশন")])],-1)),e("tbody",null,[y(c).loading?(i(),u("tr",re,[e("td",de,[q(D,{class:"shadow-none"})])])):((t=y(c).incomes)==null?void 0:t.length)===0?(i(),u("tr",ie,s[0]||(s[0]=[e("td",{colspan:"7",class:"text-center py-6 text-gray-500"},"No incomes found",-1)]))):(i(!0),u(w,{key:2},S(y(c).incomes,o=>{var d;return i(),u("tr",{key:o.id,class:"hover:bg-gray-50 transition ease-in-out"},[e("td",ue,x(o.id),1),e("td",ce,x(new Date(o.date).toLocaleDateString("bn-BD",{day:"2-digit",month:"long",year:"numeric"})),1),e("td",pe,x((d=o.income_head)==null?void 0:d.name),1),e("td",me,x(o.description),1),e("td",ye,"৳"+x(o.amount),1),e("td",xe,[e("button",{class:"btn-primary py-1 px-3 rounded-md text-white bg-blue-500 hover:bg-blue-600 transition",onClick:a=>r(o)}," Edit ",8,ve)])])}),128))])])]),y(c).error?(i(),u("div",be,x(y(c).error),1)):I("",!0)]),n.value&&l.value?(i(),E(oe,{key:0,income:l.value,isOpen:n.value,onClose:v,class:"z-50"},null,8,["income","isOpen"])):I("",!0),n.value&&!l.value?(i(),E(Q,{key:1,isOpen:n.value,onClose:v,class:"z-50"},null,8,["isOpen"])):I("",!0)],64)}}};export{Ie as default};
