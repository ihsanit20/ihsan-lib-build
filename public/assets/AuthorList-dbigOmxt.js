import{u as w}from"./author-CoBWMUWG.js";import{A as O,D,o as n,c,a as e,w as P,b as y,v as x,r as d,e as j,p as E,g as h,F as S,q,t as g,i as _,s as M}from"./index-BAp8XM6X.js";import{_ as z}from"./HeaderWithButtons-Ccx13PVj.js";import{L as T}from"./LoaderView-CHdIRFyE.js";import{_ as G}from"./PhotoModal-DByYfL17.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"modal-bg"},I={class:"modal-card"},J={class:"flex justify-end space-x-4"},K={__name:"EditAuthor",props:{author:Object},emits:["close","updated"],setup(f,{emit:u}){const l=u,s=f,a=O({name:"",bio:""}),p=w();D(()=>s.author,o=>{a.name=o.name||"",a.bio=o.bio||""},{immediate:!0});const m=async()=>{await p.updateAuthor(s.author.id,a),l("updated"),l("close")};return(o,t)=>(n(),c("div",H,[e("div",I,[t[6]||(t[6]=e("h2",{class:"text-xl font-bold text-center"},"Edit Author",-1)),e("form",{onSubmit:P(m,["prevent"]),class:"space-y-4"},[e("div",null,[t[3]||(t[3]=e("label",null,"Name",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>a.name=i),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[x,a.name]])]),e("div",null,[t[4]||(t[4]=e("label",null,"Bio",-1)),y(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=i=>a.bio=i),class:"w-full p-2 border rounded"},null,512),[[x,a.bio]])]),e("div",J,[t[5]||(t[5]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},"Save",-1)),e("button",{type:"button",onClick:t[2]||(t[2]=i=>l("close")),class:"bg-gray-500 text-white px-4 py-2 rounded"}," Cancel ")])],32)])]))}},Q={class:"modal-bg"},R={class:"modal-card"},W={class:"flex justify-end space-x-4"},X={__name:"AddAuthor",emits:["close","saved"],setup(f,{emit:u}){const l=u,s=O({name:"",bio:""}),a=w(),p=async()=>{await a.createAuthor(s),l("saved"),l("close")};return(m,o)=>(n(),c("div",Q,[e("div",R,[o[6]||(o[6]=e("h2",{class:"text-xl font-bold text-center"},"Add Author",-1)),e("form",{onSubmit:P(p,["prevent"]),class:"space-y-4"},[e("div",null,[o[3]||(o[3]=e("label",null,"Name",-1)),y(e("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>s.name=t),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[x,s.name]])]),e("div",null,[o[4]||(o[4]=e("label",null,"Bio",-1)),y(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=t=>s.bio=t),class:"w-full p-2 border rounded"},null,512),[[x,s.bio]])]),e("div",W,[o[5]||(o[5]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},"Save",-1)),e("button",{type:"button",onClick:o[2]||(o[2]=t=>l("close")),class:"bg-gray-500 text-white px-4 py-2 rounded"}," Cancel ")])],32)])]))}},Y={class:"my-container space-y-4"},Z={class:"overflow-x-auto bg-white shadow rounded-lg"},ee={class:"table-auto w-full border-collapse border border-gray-200"},te={key:0},oe={colspan:"4",class:"text-center py-6"},se={key:1},le={class:"px-4 py-3 border border-gray-200"},ae=["onClick","src"],re={class:"px-4 py-3 border border-gray-200"},ne={class:"px-4 py-3 border border-gray-200"},de={class:"line-clamp-3"},ue={class:"px-4 py-3 border border-gray-200 text-center"},ie=["onClick"],ce={key:0,class:"mt-4 text-red-600 text-sm text-center"},fe={__name:"AuthorList",setup(f){const u=w(),l=d(!1),s=d(null),a=d(null),p=d(!0),m=d(!1),o=d(null),t=d(null),i=d(!1),A=d(!1);j(async()=>{try{await u.fetchAuthors()}catch(r){a.value=r.message}finally{p.value=!1}});const k=E(()=>[...u.authors].sort((r,b)=>new Date(b.created_at)-new Date(r.created_at))),V=r=>{s.value=r,l.value=!0},U=()=>{s.value=null,l.value=!0},$=()=>{l.value=!1,s.value=null},B=r=>{s.value=r,o.value=r.photo,m.value=!0},C=()=>{m.value=!1,t.value=null},F=r=>{t.value=r},L=async()=>{if(!(!t.value||!s.value))try{i.value=!0,await u.uploadPhoto(s.value.id,t.value),await u.fetchAuthors(),A.value=!0,setTimeout(()=>{C(),i.value=!1,A.value=!1},1500)}catch(r){console.error("Failed to upload photo:",r)}finally{i.value=!1}};return(r,b)=>(n(),c(S,null,[e("div",Y,[h(z,{title:"Author List",onAdd:U}),e("div",Z,[e("table",ee,[b[1]||(b[1]=e("thead",null,[e("tr",{class:"bg-gray-200 text-left text-gray-700 uppercase text-sm tracking-wider"},[e("th",{class:"px-4 py-3 border border-gray-200"},"ছবি"),e("th",{class:"px-4 py-3 border border-gray-200"},"লেখকের নাম"),e("th",{class:"px-4 py-3 border border-gray-200"},"বিস্তারিত"),e("th",{class:"px-4 py-3 border border-gray-200 text-center"},"একশন")])],-1)),e("tbody",null,[p.value?(n(),c("tr",te,[e("td",oe,[h(T,{class:"shadow-none"})])])):k.value.length===0?(n(),c("tr",se,b[0]||(b[0]=[e("td",{colspan:"4",class:"text-center py-6 text-gray-500"},"No authors found",-1)]))):(n(!0),c(S,{key:2},q(k.value,v=>(n(),c("tr",{key:v.id,class:"hover:bg-gray-50 transition ease-in-out"},[e("td",le,[e("img",{onClick:N=>B(v),src:v.photo,alt:"Photo",class:"rounded-full object-cover size-12 cursor-pointer"},null,8,ae)]),e("td",re,g(v.name),1),e("td",ne,[e("span",de,g(v.bio||"নেই"),1)]),e("td",ue,[e("button",{class:"btn-primary py-1 px-3 rounded-md text-white bg-blue-500 hover:bg-blue-600 transition",onClick:N=>V(v)}," Edit ",8,ie)])]))),128))])])]),a.value?(n(),c("div",ce,g(a.value),1)):_("",!0)]),l.value&&s.value?(n(),M(K,{key:0,author:s.value,isOpen:l.value,onClose:$,class:"z-50"},null,8,["author","isOpen"])):_("",!0),l.value&&!s.value?(n(),M(X,{key:1,isOpen:l.value,onClose:$,class:"z-50"},null,8,["isOpen"])):_("",!0),h(G,{imageSrc:o.value,isOpen:m.value,onClose:C,onFileSelected:F,onUploadPhoto:L},null,8,["imageSrc","isOpen"])],64))}};export{fe as default};
