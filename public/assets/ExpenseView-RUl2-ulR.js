import{_ as D}from"./HeaderWithButtons-BYuVYrIe.js";import{b as E,L as N}from"./index-DG3aClSM.js";import{d as I,r as g,N as M,k,c as i,o as u,b as e,J as F,a as h,l as b,s as _,K as H,F as w,h as S,t as y,u as m,q as L,x as q,e as U}from"./vue-DFkF7ryY.js";import{u as O}from"./income-expense-head-6Ba5V6Dk.js";import"./vendor-BtuGy7By.js";const V=I("expense",()=>{const x=g([]),p=g(null),o=g(!1),l=g(null);return{expenses:x,expense:p,loading:o,error:l,fetchExpenses:async(t={})=>{var n,d;o.value=!0,l.value=null;try{const a=await E.get("/expenses",{params:t});x.value=a.data}catch(a){l.value=((d=(n=a.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to fetch expenses"}finally{o.value=!1}},fetchExpense:async t=>{var n,d;o.value=!0,l.value=null;try{const a=await E.get(`/expenses/${t}`);p.value=a.data}catch(a){l.value=((d=(n=a.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to fetch expense"}finally{o.value=!1}},createExpense:async t=>{var n,d;o.value=!0,l.value=null;try{const a=await E.post("/expenses",t);x.value.push(a.data)}catch(a){throw l.value=((d=(n=a.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to create expense",a}finally{o.value=!1}},updateExpense:async(t,n)=>{var d,a;o.value=!0,l.value=null;try{const $=await E.put(`/expenses/${t}`,n),C=x.value.findIndex(B=>B.id===t);C!==-1&&(x.value[C]=$.data)}catch($){throw l.value=((a=(d=$.response)==null?void 0:d.data)==null?void 0:a.message)||"Failed to update expense",$}finally{o.value=!1}},deleteExpense:async t=>{var n,d;o.value=!0,l.value=null;try{await E.delete(`/expenses/${t}`),x.value=x.value.filter(a=>a.id!==t)}catch(a){throw l.value=((d=(n=a.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to delete expense",a}finally{o.value=!1}}}}),j={class:"modal-bg"},A={class:"modal-card"},z={class:"grid md:grid-cols-2 gap-4"},J={class:"col-span-full"},K=["value"],T={class:"col-span-full"},G={class:"mt-4 text-red-600 text-sm text-center"},P={class:"flex justify-end space-x-4"},Q={__name:"AddExpense",emits:["close","saved"],setup(x,{emit:p}){const o=p,l=M({date:"",income_expense_head_id:"",amount:"",description:""}),r=O(),c=V(),v=async()=>{await c.createExpense(l),o("saved"),o("close"),c.fetchExpenses()};return k(async()=>{r.fetchIncomeExpenseHeads({type:"Expense"})}),(f,s)=>(u(),i("div",j,[e("div",A,[s[13]||(s[13]=e("h2",{class:"text-2xl font-bold text-center"},"নতুন ব্যয় যুক্ত করুন",-1)),s[14]||(s[14]=e("hr",{class:"my-2"},null,-1)),e("form",{onSubmit:F(v,["prevent"]),class:"space-y-4"},[e("div",z,[e("div",null,[s[5]||(s[5]=e("label",null,"তারিখ",-1)),b(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>l.date=t),type:"date",class:"w-full p-2 border rounded",required:""},null,512),[[_,l.date]])]),e("div",null,[s[6]||(s[6]=e("label",null,"পরিমাণ",-1)),b(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>l.amount=t),type:"number",class:"w-full p-2 border rounded text-right",required:""},null,512),[[_,l.amount]])]),e("div",J,[s[8]||(s[8]=e("label",null,"ব্যয়ের খাত",-1)),b(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>l.income_expense_head_id=t),class:"w-full p-2 border rounded",required:""},[s[7]||(s[7]=e("option",{value:""},"- ব্যয়ের খাত নির্বাচন করুন -",-1)),(u(!0),i(w,null,S(m(r).incomeExpenseHeads,t=>(u(),i("option",{key:t.id,value:t.id},y(t.name),9,K))),128))],512),[[H,l.income_expense_head_id]])]),e("div",T,[s[9]||(s[9]=e("label",null,"বিবরণ",-1)),b(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>l.description=t),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[_,l.description]])])]),m(c).error?(u(),i(w,{key:0},[s[10]||(s[10]=e("hr",{class:"my-2"},null,-1)),e("div",G,y(m(c).error),1)],64)):h("",!0),s[12]||(s[12]=e("hr",{class:"my-2"},null,-1)),e("div",P,[s[11]||(s[11]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},"Save",-1)),e("button",{type:"button",onClick:s[4]||(s[4]=t=>o("close")),class:"bg-gray-500 text-white px-4 py-2 rounded"}," Cancel ")])],32)])]))}},R={class:"modal-bg"},W={class:"modal-card"},X={class:"grid md:grid-cols-2 gap-4"},Y={class:"col-span-full"},Z=["value"],ee={class:"col-span-full"},te={class:"mt-4 text-red-600 text-sm text-center"},se={class:"flex justify-end space-x-4"},ne={__name:"EditExpense",props:{expense:Object},emits:["close","updated"],setup(x,{emit:p}){const o=p,l=x,r=M({date:"",income_expense_head_id:"",amount:"",description:""}),c=V(),v=O();L(()=>l.expense,s=>{r.date=s.date||"",r.income_expense_head_id=s.income_expense_head_id||"",r.amount=s.amount||"",r.description=s.description||""},{immediate:!0});const f=async()=>{await c.updateExpense(l.expense.id,r),o("updated"),o("close"),c.fetchExpenses()};return k(async()=>{v.fetchIncomeExpenseHeads({type:"Expense"})}),(s,t)=>(u(),i("div",R,[e("div",W,[t[13]||(t[13]=e("h2",{class:"text-2xl font-bold text-center"},"ব্যয় সম্পাদন করুন",-1)),t[14]||(t[14]=e("hr",{class:"my-2"},null,-1)),e("form",{onSubmit:F(f,["prevent"]),class:"space-y-4"},[e("div",X,[e("div",null,[t[5]||(t[5]=e("label",null,"তারিখ",-1)),b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>r.date=n),type:"date",class:"w-full p-2 border rounded",required:""},null,512),[[_,r.date]])]),e("div",null,[t[6]||(t[6]=e("label",null,"পরিমাণ",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>r.amount=n),type:"number",class:"w-full p-2 border rounded text-right",required:""},null,512),[[_,r.amount]])]),e("div",Y,[t[8]||(t[8]=e("label",null,"ব্যয়ের খাত",-1)),b(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>r.income_expense_head_id=n),class:"w-full p-2 border rounded",required:""},[t[7]||(t[7]=e("option",{value:""},"- ব্যয়ের খাত নির্বাচন করুন -",-1)),(u(!0),i(w,null,S(m(v).incomeExpenseHeads,n=>(u(),i("option",{key:n.id,value:n.id},y(n.name),9,Z))),128))],512),[[H,r.income_expense_head_id]])]),e("div",ee,[t[9]||(t[9]=e("label",null,"বিবরণ",-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>r.description=n),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[_,r.description]])])]),m(c).error?(u(),i(w,{key:0},[t[10]||(t[10]=e("hr",{class:"my-2"},null,-1)),e("div",te,y(m(c).error),1)],64)):h("",!0),t[12]||(t[12]=e("hr",{class:"my-2"},null,-1)),e("div",se,[t[11]||(t[11]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},"Update",-1)),e("button",{type:"button",onClick:t[4]||(t[4]=n=>o("close")),class:"bg-gray-500 text-white px-4 py-2 rounded"}," Cancel ")])],32)])]))}},le={class:"my-container space-y-4"},oe={class:"overflow-x-auto bg-white shadow rounded-lg"},ae={class:"table-auto w-full border-collapse border border-gray-200"},re={key:0},de={colspan:"7",class:"text-center py-6"},ue={key:1},ie={class:"px-4 py-3 border border-gray-200 text-center"},pe={class:"px-4 py-3 border border-gray-200 text-center"},ce={class:"px-4 py-3 border border-gray-200 text-center"},xe={class:"px-4 py-3 border border-gray-200 text-left"},me={class:"px-4 py-3 border border-gray-200 text-center"},ye={class:"px-4 py-3 border border-gray-200 text-center"},ve=["onClick"],be={key:0,class:"mt-4 text-red-600 text-sm text-center"},he={__name:"ExpenseView",setup(x){const p=V(),o=g(null),l=g(!1);k(async()=>{await p.fetchExpenses()});const r=f=>{o.value=f,l.value=!0},c=()=>{o.value=null,l.value=!0},v=()=>{l.value=!1,o.value=null};return(f,s)=>{var t;return u(),i(w,null,[e("div",le,[U(D,{title:"ব্যয়ের তালিকা",onAdd:c}),e("div",oe,[e("table",ae,[s[1]||(s[1]=e("thead",null,[e("tr",{class:"bg-gray-200 text-left text-gray-700 text-sm tracking-wider"},[e("th",{class:"px-4 py-3 border text-center"},"#"),e("th",{class:"px-4 py-3 border text-center"},"তারিখ"),e("th",{class:"px-4 py-3 border text-center"},"খাত"),e("th",{class:"px-4 py-3 border"},"বিবরণ"),e("th",{class:"px-4 py-3 border text-center"},"পরিমাণ"),e("th",{class:"px-4 py-3 border text-center"},"একশন")])],-1)),e("tbody",null,[m(p).loading?(u(),i("tr",re,[e("td",de,[U(N,{class:"shadow-none"})])])):((t=m(p).expenses)==null?void 0:t.length)===0?(u(),i("tr",ue,s[0]||(s[0]=[e("td",{colspan:"7",class:"text-center py-6 text-gray-500"},"No expenses found",-1)]))):(u(!0),i(w,{key:2},S(m(p).expenses,n=>{var d;return u(),i("tr",{key:n.id,class:"hover:bg-gray-50 transition ease-in-out"},[e("td",ie,y(n.id),1),e("td",pe,y(new Date(n.date).toLocaleDateString("bn-BD",{day:"2-digit",month:"long",year:"numeric"})),1),e("td",ce,y((d=n.expense_head)==null?void 0:d.name),1),e("td",xe,y(n.description),1),e("td",me,"৳"+y(n.amount),1),e("td",ye,[e("button",{class:"btn-primary py-1 px-3 rounded-md text-white bg-blue-500 hover:bg-blue-600 transition",onClick:a=>r(n)}," Edit ",8,ve)])])}),128))])])]),m(p).error?(u(),i("div",be,y(m(p).error),1)):h("",!0)]),l.value&&o.value?(u(),q(ne,{key:0,expense:o.value,isOpen:l.value,onClose:v,class:"z-50"},null,8,["expense","isOpen"])):h("",!0),l.value&&!o.value?(u(),q(Q,{key:1,isOpen:l.value,onClose:v,class:"z-50"},null,8,["isOpen"])):h("",!0)],64)}}};export{he as default};
