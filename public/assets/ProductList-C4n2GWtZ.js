import{d as F,L as A}from"./index-DgqlB-jz.js";import{_ as B}from"./PhotoModal-BXvyFLRg.js";import{r,k as V,f as D,c as n,b as e,e as c,a as M,w as m,m as O,F as h,h as L,t as l,o as d,p as y}from"./vue-DFkF7ryY.js";import"./vendor-BtuGy7By.js";const U={class:"my-container space-y-4"},E={class:"flex items-center justify-between gap-2"},I={class:"overflow-x-auto bg-white shadow rounded-lg"},R={class:"table-auto w-full border-collapse border border-gray-200"},T={key:0},$={colspan:"6"},q={key:1},z={class:"px-2 py-3 border border-gray-200 text-center"},G={class:"px-2 py-1.5 border border-gray-200 min-w-max"},H={class:"flex justify-center md:justify-start min-w-max"},J=["onClick","src"],K={class:"px-4 py-3 border border-gray-200"},Q={class:"md:flex flex-wrap gap-2 text-sm max-w-max"},W={class:"font-medium inline-flex flex-wrap gap-x-1 min-w-max"},X={class:"font-medium inline-flex flex-wrap gap-x-1 min-w-max"},Y={class:"px-4 py-3 border border-gray-200"},Z={class:"px-4 py-3 border border-gray-200"},ee={class:"min-w-max"},te={class:"px-4 py-3 border border-gray-200"},se={class:"min-w-max text-center"},oe={class:"px-4 py-3 border border-gray-200"},ae={class:"flex justify-center gap-4"},le={key:0,class:"mt-4 text-red-600 text-sm text-center"},ue={__name:"ProductList",setup(re){const u=F(),x=r(null),f=r(null),_=r(!0),b=r(!1),v=r(null),p=r(null),g=r(!1),w=r(!1);V(async()=>{var o,t;try{await u.fetchProducts()}catch(i){x.value=((t=(o=i.response)==null?void 0:o.data)==null?void 0:t.message)||"Failed to fetch products"}finally{_.value=!1}});const P=D(()=>Array.isArray(u.products)?[...u.products].sort((o,t)=>parseInt(o.id)-parseInt(t.id)):[]),N=o=>{f.value=o,v.value=o.photo,b.value=!0},k=()=>{b.value=!1,p.value=null},j=o=>{p.value=o},C=async()=>{if(!(!p.value||!f.value))try{g.value=!0,await u.uploadPhoto(f.value.id,p.value),await u.fetchProducts(),w.value=!0,setTimeout(()=>{k(),g.value=!1,w.value=!1},1500)}catch(o){console.error("Failed to upload photo:",o)}finally{g.value=!1}};return(o,t)=>{const i=O("RouterLink");return d(),n(h,null,[e("div",U,[e("div",E,[t[1]||(t[1]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"পণ্য তালিকা",-1)),c(i,{to:{name:"ProductAdd"},class:"btn-2"},{default:m(()=>t[0]||(t[0]=[e("span",{class:"hidden md:flex"},"নতুন বই",-1),e("i",{class:"far fa-plus"},null,-1)])),_:1})]),e("div",I,[e("table",R,[t[10]||(t[10]=e("thead",null,[e("tr",{class:"bg-gray-200 text-left text-gray-700 uppercase text-sm tracking-wider"},[e("th",{class:"px-2 py-3 border border-gray-200 text-center"},"#"),e("th",{class:"px-4 py-3 border border-gray-200"},"ছবি"),e("th",{class:"px-4 py-3 border border-gray-200"},"পণ্যের নাম ও দাম"),e("th",{class:"px-4 py-3 border border-gray-200"},"লেখক/অনুবাদক"),e("th",{class:"px-4 py-3 border border-gray-200"},"ক্যাটাগরি"),e("th",{class:"px-4 py-3 border border-gray-200 text-center"},"স্টক"),e("th",{class:"px-4 py-3 border border-gray-200 text-center"},"একশন")])],-1)),e("tbody",null,[_.value?(d(),n("tr",T,[e("td",$,[c(A,{class:"shadow-none"})])])):P.value.length===0?(d(),n("tr",q,t[2]||(t[2]=[e("td",{colspan:"6",class:"text-center py-6 text-gray-500"}," কোন প্রডাক্ট পাওয়া যায়নি। ",-1)]))):(d(!0),n(h,{key:2},L(P.value,s=>{var S;return d(),n("tr",{key:s.id,class:"hover:bg-gray-50 transition ease-in-out"},[e("td",z,l(s.id),1),e("td",G,[e("div",H,[e("img",{onClick:a=>N(s),src:s.photo,alt:"Photo",class:"w-14 aspect-[3/4] rounded shadow-sm object-cover cursor-pointer"},null,8,J)])]),e("td",K,[c(i,{to:{name:"ProductShow",params:{id:s.id}},class:"title-md line-clamp-2",title:s.name},{default:m(()=>[y(l(s.name),1)]),_:2},1032,["to","title"]),e("div",Q,[e("p",W,[t[3]||(t[3]=e("b",null,"খুচরা মূল্য:",-1)),e("span",null,l(Number(s.mrp).toLocaleString("bn-BD"))+" টাকা",1)]),e("p",X,[t[4]||(t[4]=e("b",null,"বিক্রয় মূল্য:",-1)),e("span",null,l(Number(s.selling_price).toLocaleString("bn-BD"))+" টাকা",1)])])]),e("td",Y,[e("div",null,[e("p",null,[t[5]||(t[5]=e("strong",null,"প্রকাশক:",-1)),y(" "+l(((S=s==null?void 0:s.publisher)==null?void 0:S.name)||"N/A"),1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"লেখক:",-1)),y(" "+l(s.authors.filter(a=>a.role==="author").map(a=>a.name).join(", ")||"N/A"),1)]),e("p",null,[t[7]||(t[7]=e("strong",null,"অনুবাদক:",-1)),y(" "+l(s.authors.filter(a=>a.role==="translator").map(a=>a.name).join(", ")||"N/A"),1)])])]),e("td",Z,[e("div",ee,[(d(!0),n(h,null,L(s.categories,a=>(d(),n("p",{key:a},l(a),1))),128))])]),e("td",te,[e("p",se,l(Number(s.available_stock).toLocaleString("bn-BD"))+" টি ",1)]),e("td",oe,[e("div",ae,[c(i,{to:{name:"ProductShow",params:{id:s.id}},class:"btn-icon"},{default:m(()=>t[8]||(t[8]=[e("i",{class:"fad fa-eye"},null,-1)])),_:2},1032,["to"]),c(i,{to:{name:"ProductEdit",params:{id:s.id}},class:"btn-icon"},{default:m(()=>t[9]||(t[9]=[e("i",{class:"fad fa-edit"},null,-1)])),_:2},1032,["to"])])])])}),128))])])]),x.value?(d(),n("div",le,l(x.value),1)):M("",!0)]),c(B,{imageSrc:v.value,isOpen:b.value,onClose:k,onFileSelected:j,onUploadPhoto:C},null,8,["imageSrc","isOpen"])],64)}}};export{ue as default};
