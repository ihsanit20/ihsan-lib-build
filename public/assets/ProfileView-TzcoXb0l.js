import{r as s,k as B,c as x,b as t,e as U,t as c,p as n,w as N,m as j,J as A,l as m,s as b,F as O,o as w}from"./vue-DFkF7ryY.js";import{_ as T}from"./PhotoModal-BXvyFLRg.js";import{u as L}from"./index-rzlRsLqz.js";import"./vendor-BtuGy7By.js";const R={class:"my-container max-w-xl"},z={class:"card-bg p-4 md:p-8 flex flex-col items-center relative"},J={class:"flex justify-center w-full"},$=["src"],q={key:0,class:"space-y-4"},G={class:"title-md text-center"},H={key:1},I={class:"flex gap-2 items-center"},K={class:"flex gap-2 items-center"},Q={class:"flex gap-2 items-center"},W={class:"flex gap-2 items-center"},le={__name:"ProfileView",setup(X){const i=L(),l=s({}),u=s(!1),r=s(""),d=s(""),p=s(""),v=s(""),g=s(!1),P=s(null),f=s(null),h=s(!1),_=s(!1),C=()=>{P.value=l.value.photo,g.value=!0},k=()=>{g.value=!1,f.value=null},S=()=>{u.value=!0,r.value=l.value.name,d.value=l.value.phone,p.value=l.value.date_of_birth,v.value=l.value.address},V=()=>{u.value=!1},D=async()=>{const o={name:r.value,phone:d.value,date_of_birth:p.value,address:v.value};await i.updateProfile(o),u.value=!1,await y()},y=async()=>{await i.fetchUser(),l.value=i.user};B(async()=>{await y()});const F=o=>{f.value=o},M=async()=>{if(!f.value)return;const o=new FormData;o.append("photo",f.value),o.append("user_id",l.value.id);try{h.value=!0,await i.uploadPhoto(o),await y(),_.value=!0,setTimeout(()=>{k(),h.value=!1,_.value=!1},1500)}catch(e){console.error("Failed to upload photo:",e)}finally{h.value=!1}};return(o,e)=>{const E=j("RouterLink");return w(),x(O,null,[t("div",R,[t("div",z,[e[15]||(e[15]=t("h1",{class:"title-lg"},"My Profile",-1)),t("div",{onClick:C,class:"bg-gray-200 size-40 rounded-full overflow-hidden relative"},[t("div",J,[t("img",{class:"object-cover",src:l.value.photo,alt:"Profile Photo"},null,8,$)])]),u.value?(w(),x("div",H,[e[14]||(e[14]=t("h1",{class:"text-center title-md"},"Edit Profile",-1)),t("form",{onSubmit:A(D,["prevent"]),class:"space-y-2"},[t("div",I,[e[9]||(e[9]=t("label",{for:"name"},"Name:",-1)),m(t("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),type:"text",class:"input-1"},null,512),[[b,r.value]])]),t("div",K,[e[10]||(e[10]=t("label",{for:"phone"},"Phone:",-1)),m(t("input",{id:"phone","onUpdate:modelValue":e[1]||(e[1]=a=>d.value=a),type:"text",class:"input-1"},null,512),[[b,d.value]])]),t("div",Q,[e[11]||(e[11]=t("label",{for:"date_of_birth"},"Date of Birth:",-1)),m(t("input",{id:"date_of_birth","onUpdate:modelValue":e[2]||(e[2]=a=>p.value=a),type:"date",class:"input-1"},null,512),[[b,p.value]])]),t("div",W,[e[12]||(e[12]=t("label",{for:"address"},"Address:",-1)),m(t("input",{id:"address","onUpdate:modelValue":e[3]||(e[3]=a=>v.value=a),type:"text",class:"input-1"},null,512),[[b,v.value]])]),t("div",{class:"flex justify-center gap-4"},[t("button",{class:"btn-3",onClick:V},"Cancel"),e[13]||(e[13]=t("button",{class:"btn-2",type:"submit"},"Update",-1))])],32)])):(w(),x("div",q,[t("p",G,c(l.value.name),1),t("p",null,[e[4]||(e[4]=t("strong",null,"Phone:",-1)),n(" "+c(l.value.phone),1)]),t("p",null,[e[5]||(e[5]=t("strong",null,"Date of Birth:",-1)),n(" "+c(l.value.date_of_birth),1)]),t("p",null,[e[6]||(e[6]=t("strong",null,"Address:",-1)),n(" "+c(l.value.address),1)]),t("button",{class:"btn-2 absolute top-4 right-4",onClick:S},e[7]||(e[7]=[t("i",{class:"far fa-edit"},null,-1),n("Edit ")])),U(E,{class:"btn-2",to:"/profile/change-password"},{default:N(()=>e[8]||(e[8]=[n(" Change Password ")])),_:1})]))])]),U(T,{imageSrc:P.value,isOpen:g.value,onClose:k,onFileSelected:F,onUploadPhoto:M},null,8,["imageSrc","isOpen"])],64)}}};export{le as default};
