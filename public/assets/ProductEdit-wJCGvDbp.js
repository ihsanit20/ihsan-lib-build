import{r as u,e as z,c as o,a as t,s as G,b as m,v as C,F as y,q as k,x as A,m as w,t as p,i as H,w as J,k as K,o as a,d as O}from"./index-BAp8XM6X.js";import{u as Q}from"./product-B6A0mxCI.js";import{u as W}from"./category-DbnE3cl2.js";import{u as X}from"./author-CoBWMUWG.js";import{L as Y}from"./LoaderView-CHdIRFyE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"my-container space-y-4"},ee={class:"flex items-center justify-between gap-2"},te=["disabled"],le={key:1,class:"card-bg md:p-8 p-4"},se={class:"grid grid-cols-2 gap-4"},ae={class:"p-4 border-2 rounded-md"},oe={class:"flex flex-wrap gap-2"},ue=["onClick"],ne={class:"mt-2 relative"},de=["value","disabled"],re={class:"p-4 border-2 rounded-md"},ie={class:"flex flex-wrap gap-2"},ve=["onClick"],ce={class:"mt-2 relative"},me=["value","disabled"],pe={class:"p-4 border-2 rounded-md"},fe={class:"flex flex-wrap gap-2"},be=["onClick"],xe={class:"mt-2 relative"},ge=["value","disabled"],ye={key:0,class:"text-red-500 text-sm"},ke={class:"flex justify-center"},we=["disabled"],he={key:0},Ce={key:1},Ie={__name:"ProductEdit",setup(Se){const q=O(),L=K(),N=Q(),S=W(),h=X(),I=L.params.id,_=u(""),B=u(""),P=u(""),U=u(""),V=u(""),d=u([]),f=u(null),r=u([]),b=u(null),i=u([]),x=u(null),v=u(!1),g=u(null);z(async()=>{v.value=!0,g.value=null;try{await S.fetchCategories(),await h.fetchAuthors(),await N.fetchProduct(I);const s=N.product;_.value=s.name,B.value=s.mrp,P.value=s.selling_price,U.value=s.ISBN,V.value=s.description,d.value=s.categories.map(e=>{var l;return(l=S.categories.find(n=>n.name===e))==null?void 0:l.id}).filter(e=>e),r.value=s.authors.filter(e=>e.role==="author").map(e=>e.id),i.value=s.authors.filter(e=>e.role==="translator").map(e=>e.id)}catch(s){g.value=s.message||"Failed to fetch product"}finally{v.value=!1}});const M=()=>{f.value&&!d.value.includes(f.value)&&d.value.push(f.value),f.value=null},T=s=>{d.value=d.value.filter(e=>e!==s)},E=()=>{b.value&&!r.value.includes(b.value)&&r.value.push(b.value),b.value=null},$=s=>{r.value=r.value.filter(e=>e!==s)},j=()=>{x.value&&!i.value.includes(x.value)&&i.value.push(x.value),x.value=null},D=s=>{i.value=i.value.filter(e=>e!==s)},F=async()=>{v.value=!0,g.value=null;try{const s=[...r.value.map(e=>({id:e,role:"author"})),...i.value.map(e=>({id:e,role:"translator"}))];await N.updateProduct(I,{name:_.value,ISBN:U.value,description:V.value,categories:d.value,authors:s,mrp:B.value,selling_price:P.value}),alert("Product updated successfully!"),q.push({name:"ProductShow",params:{id:I}})}catch(s){g.value=s.message||"Failed to update product"}finally{v.value=!1}},R=()=>{q.go(-1)};return(s,e)=>(a(),o("div",Z,[t("div",ee,[t("button",{class:"btn-3",onClick:R},e[8]||(e[8]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[10]||(e[10]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Edit Product",-1)),t("button",{class:"btn-2",onClick:F,disabled:v.value},e[9]||(e[9]=[t("span",{class:"hidden md:flex"},"Update",-1),t("i",{class:"far fa-save"},null,-1)]),8,te)]),v.value?(a(),G(Y,{key:0})):(a(),o("div",le,[t("form",{onSubmit:J(F,["prevent"]),class:"space-y-6"},[t("div",null,[e[11]||(e[11]=t("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"পণ্যের নাম",-1)),m(t("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l),type:"text",class:"input-1",required:""},null,512),[[C,_.value]])]),t("div",se,[t("div",null,[e[12]||(e[12]=t("label",{for:"mrp",class:"block text-sm font-medium text-gray-700"},"মুদ্রিত মূল্য",-1)),m(t("input",{id:"mrp","onUpdate:modelValue":e[1]||(e[1]=l=>B.value=l),type:"number",class:"input-1",required:""},null,512),[[C,B.value]])]),t("div",null,[e[13]||(e[13]=t("label",{for:"sellingPrice",class:"block text-sm font-medium text-gray-700"}," বিক্রয় মূল্য ",-1)),m(t("input",{id:"sellingPrice","onUpdate:modelValue":e[2]||(e[2]=l=>P.value=l),type:"number",class:"input-1",required:""},null,512),[[C,P.value]])])]),t("div",null,[e[14]||(e[14]=t("label",{for:"ISBN",class:"block text-sm font-medium text-gray-700"},"ISBN",-1)),m(t("input",{id:"ISBN","onUpdate:modelValue":e[3]||(e[3]=l=>U.value=l),type:"text",class:"input-1"},null,512),[[C,U.value]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700"}," বিস্তারিত বিবরণ ",-1)),m(t("textarea",{id:"description","onUpdate:modelValue":e[4]||(e[4]=l=>V.value=l),rows:"4",class:"input-1"},null,512),[[C,V.value]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ক্যাটাগরি",-1)),t("div",ae,[t("div",oe,[(a(!0),o(y,null,k(d.value,l=>{var n;return a(),o("div",{key:l,class:"flex items-center bg-blue-100 text-blue-700 px-3 py-1 rounded-full"},[t("span",null,p(((n=w(S).categories.find(c=>c.id===l))==null?void 0:n.name)||"Unknown Category"),1),t("button",{type:"button",onClick:c=>T(l),class:"ml-2 text-blue-500 hover:text-blue-800"}," × ",8,ue)])}),128))]),t("div",ne,[m(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>f.value=l),onChange:M,class:"input-1"},[e[16]||(e[16]=t("option",{value:"",disabled:""},"- সিলেক্ট ক্যাটাগরি -",-1)),(a(!0),o(y,null,k(w(S).categories,l=>(a(),o("option",{key:l.id,value:l.id,disabled:d.value.includes(l.id)},p(l.name),9,de))),128))],544),[[A,f.value]])])])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"লেখক",-1)),t("div",re,[t("div",ie,[(a(!0),o(y,null,k(r.value,l=>{var n;return a(),o("div",{key:l,class:"flex items-center bg-green-100 text-green-700 px-3 py-1 rounded-full"},[t("span",null,p((n=w(h).authors.find(c=>c.id===l))==null?void 0:n.name),1),t("button",{type:"button",onClick:c=>$(l),class:"ml-2 text-green-500 hover:text-green-800"}," × ",8,ve)])}),128))]),t("div",ce,[m(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>b.value=l),onChange:E,class:"input-1"},[e[18]||(e[18]=t("option",{value:"",disabled:""},"- সিলেক্ট লেখক -",-1)),(a(!0),o(y,null,k(w(h).authors,l=>(a(),o("option",{key:l.id,value:l.id,disabled:r.value.includes(l.id)},p(l.name),9,me))),128))],544),[[A,b.value]])])])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"অনুবাদক",-1)),t("div",pe,[t("div",fe,[(a(!0),o(y,null,k(i.value,l=>{var n;return a(),o("div",{key:l,class:"flex items-center bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full"},[t("span",null,p((n=w(h).authors.find(c=>c.id===l))==null?void 0:n.name),1),t("button",{type:"button",onClick:c=>D(l),class:"ml-2 text-yellow-500 hover:text-yellow-800"}," × ",8,be)])}),128))]),t("div",xe,[m(t("select",{"onUpdate:modelValue":e[7]||(e[7]=l=>x.value=l),onChange:j,class:"input-1"},[e[20]||(e[20]=t("option",{value:"",disabled:""},"- সিলেক্ট অনুবাদক -",-1)),(a(!0),o(y,null,k(w(h).authors,l=>(a(),o("option",{key:l.id,value:l.id,disabled:i.value.includes(l.id)},p(l.name),9,ge))),128))],544),[[A,x.value]])])])]),g.value?(a(),o("div",ye,p(g.value),1)):H("",!0),t("div",ke,[t("button",{type:"submit",disabled:v.value,class:"btn-2"},[v.value?(a(),o("span",he,"Loading...")):(a(),o("span",Ce,"Update Product"))],8,we)])],32)]))]))}};export{Ie as default};
