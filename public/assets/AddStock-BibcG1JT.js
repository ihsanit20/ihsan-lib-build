import{d as w,r as v,f as x,M as I,c as _,o as F,b as n,J as B,t as D,l as y,s as m}from"./vue-D0mF8XVW.js";import{b as u}from"./index-Czyahqyo.js";const $=w("stock",()=>{const r=v([]),f=v(null),i=v(null),o=v(!1),t=v(null),k=x(()=>r.value.length);return{stocks:r,stock:f,availableStock:i,loading:o,error:t,stockCount:k,fetchStocks:async()=>{var c,s;o.value=!0,t.value=null;try{const a=await u.get("/stocks");r.value=a.data}catch(a){t.value=((s=(c=a.response)==null?void 0:c.data)==null?void 0:s.message)||"Failed to fetch stocks"}finally{o.value=!1}},fetchStocksByProductId:async c=>{var s,a;o.value=!0,t.value=null;try{const e=await u.get(`/stocks?product_id=${c}`);r.value=e.data}catch(e){t.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to fetch stocks by product ID"}finally{o.value=!1}},fetchAvailableStocks:async()=>{var c,s;o.value=!0,t.value=null;try{const a=await u.get("/available-stocks");r.value=a.data}catch(a){t.value=((s=(c=a.response)==null?void 0:c.data)==null?void 0:s.message)||"Failed to fetch stocks"}finally{o.value=!1}},fetchAvailableStockByProductId:async c=>{var s,a;o.value=!0,t.value=null;try{const e=await u.get(`/available-stock/${c}`);i.value=e.data}catch(e){throw t.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to fetch available stock by product ID",e}finally{o.value=!1}},fetchStock:async c=>{var s,a;o.value=!0,t.value=null;try{const e=await u.get(`/stocks/${c}`);f.value=e.data}catch(e){t.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to fetch stock"}finally{o.value=!1}},createStock:async c=>{var s,a;o.value=!0,t.value=null;try{const e=await u.post("/stocks",c);return r.value.push(e.data),e.data}catch(e){throw t.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to create stock",e}finally{o.value=!1}},updateStock:async(c,s)=>{var a,e;o.value=!0,t.value=null;try{const p=await u.put(`/stocks/${c}`,s),S=r.value.findIndex(h=>h.id===c);return S!==-1&&(r.value[S]=p.data),p.data}catch(p){throw t.value=((e=(a=p.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to update stock",p}finally{o.value=!1}},deleteStock:async c=>{var s,a;o.value=!0,t.value=null;try{await u.delete(`/stocks/${c}`),r.value=r.value.filter(e=>e.id!==c)}catch(e){throw t.value=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to delete stock",e}finally{o.value=!1}}}}),q={class:"modal-bg"},A={class:"modal-card"},P={class:"grid grid-cols-2 gap-4"},C={class:"font-bold"},V={class:"grid grid-cols-2 gap-4"},M={class:"flex justify-center space-x-4"},T={__name:"AddStock",props:["isOpen","productId","productName"],emits:["close","saved"],setup(r,{emit:f}){const i=f,o=r,t=I({product_id:o.productId||null,product_name:o.productName||"",quantity:0,production_price:0,stock_date:new Date().toISOString().substring(0,10)}),k=$(),b=async()=>{if(!t.product_id){alert("Product ID not provided!");return}await k.createStock(t),i("saved"),i("close")};return(g,l)=>(F(),_("div",q,[n("div",A,[l[9]||(l[9]=n("h2",{class:"text-xl font-bold text-center"},"নতুন স্টক",-1)),n("form",{onSubmit:B(b,["prevent"]),class:"space-y-4"},[n("div",P,[n("div",null,[l[4]||(l[4]=n("p",null,"পণ্যের নাম:",-1)),n("p",C,D(t.product_name),1)]),n("div",null,[l[5]||(l[5]=n("label",null,"তারিখ",-1)),y(n("input",{"onUpdate:modelValue":l[0]||(l[0]=d=>t.stock_date=d),type:"date",class:"w-full p-2 border rounded"},null,512),[[m,t.stock_date]])])]),n("div",V,[n("div",null,[l[6]||(l[6]=n("label",null,"কত পিস স্টক করছেন? (পণ্য সংখ্যা)",-1)),y(n("input",{"onUpdate:modelValue":l[1]||(l[1]=d=>t.quantity=d),type:"number",class:"w-full p-2 border rounded",required:""},null,512),[[m,t.quantity]])]),n("div",null,[l[7]||(l[7]=n("label",null,"উৎপাদন/ক্রয় মূল্য (প্রতি পিস)",-1)),y(n("input",{"onUpdate:modelValue":l[2]||(l[2]=d=>t.production_price=d),type:"number",step:"0.01",class:"w-full p-2 border rounded",required:""},null,512),[[m,t.production_price]])])]),n("div",M,[l[8]||(l[8]=n("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},"Save",-1)),n("button",{type:"button",onClick:l[3]||(l[3]=d=>i("close")),class:"bg-gray-500 text-white px-4 py-2 rounded"}," Cancel ")])],32)])]))}};export{T as _,$ as u};
