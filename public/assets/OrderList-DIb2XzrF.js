import{r as u,k as U,f as T,c as n,b as t,a as g,e as f,w as $,m as Y,l as h,s as w,F as j,h as A,t as a,p as k,o as r}from"./vue-DFkF7ryY.js";import{L as E}from"./index-imp_TQtg.js";import{u as I}from"./order-B983NO_Y.js";import{u as q}from"./payment-m5n5URqh.js";import"./vendor-BtuGy7By.js";const z={class:"my-container space-y-4"},G={class:"flex flex-col md:flex-row justify-between gap-4"},H={class:"flex items-center gap-2"},J={class:"grid gap-2 grid-cols-3 ml-auto"},K={for:"from"},Q={for:"to"},W={class:"flex items-center"},X={class:"overflow-x-auto bg-white shadow rounded-lg"},Z={class:"table-auto w-full border-collapse border border-gray-200"},tt={key:0},et={colspan:"11",class:"text-center py-6"},st={key:1},ot={class:"px-4 py-3 border border-gray-200"},at={class:"px-4 py-3 border border-gray-200"},lt={class:"px-4 py-3 border border-gray-200"},nt={class:"px-4 py-3 border border-gray-200"},rt={class:"px-4 py-3 border border-gray-200"},dt={class:"min-w-max"},ut={class:"px-4 py-3 border border-gray-200"},ct={class:"px-4 py-3 border border-gray-200"},it={class:"px-4 py-3 border border-gray-200 text-center"},pt=["onClick"],mt={class:"px-4 py-3 border border-gray-200"},yt={class:"px-4 py-3 border border-gray-200"},xt={class:"min-w-max"},bt={class:"px-4 py-3 border border-gray-200 text-center"},_t={class:"flex justify-center gap-4"},vt={key:0,class:"mt-4 text-red-600 text-sm text-center"},gt={key:0,class:"modal-bg"},ft={class:"modal-card"},ht={class:"mt-4"},wt=["max"],Ot={__name:"OrderList",setup(kt){const D=I(),C=q(),x=u(null),b=u(!0),_=u(!1),l=u(null),c=u(0),p=u(""),m=u("");function S(o){const e=o.getFullYear(),d=String(o.getMonth()+1).padStart(2,"0"),i=String(o.getDate()).padStart(2,"0");return`${e}-${d}-${i}`}function B(){const o=new Date,e=o.getFullYear(),d=o.getMonth(),i=new Date(e,d,1),y=new Date(e,d+1,0);p.value=S(i),m.value=S(y),console.log(p.value,m.value)}U(async()=>{B(),await v()});const L=T(()=>[...D.orders].sort((o,e)=>new Date(e.order_date)-new Date(o.order_date))),P=o=>{l.value=o,c.value=o.due_amount,_.value=!0},M=()=>{l.value=null,c.value=0,_.value=!1},R=async()=>{try{if(!l.value||c.value<=0){alert("Invalid payment amount");return}await C.collectDue({order_id:l.value.id,amount:c.value,payment_method:"Cash",remarks:"Collected via modal"}),alert("Payment collected successfully"),M(),v()}catch(o){console.log(o),alert(C.error||"Failed to collect due payment")}},v=async()=>{b.value=!0;try{await D.fetchOrders({from:p.value,to:m.value})}catch(o){x.value=o.message}finally{b.value=!1}};return(o,e)=>{var i,y,V,O,F;const d=Y("RouterLink");return r(),n(j,null,[t("div",z,[t("div",G,[t("div",H,[e[5]||(e[5]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"অর্ডার তালিকা",-1)),f(d,{to:{name:"OrderCreate"},class:"btn-2"},{default:$(()=>e[4]||(e[4]=[t("span",{class:"hidden lg:inline"},"অর্ডার তৈরী",-1),t("i",{class:"far fa-plus"},null,-1)])),_:1})]),t("div",J,[t("label",K,[h(t("input",{class:"input-1 max-w-xs py-1",type:"date","onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s)},null,512),[[w,p.value]])]),t("label",Q,[h(t("input",{class:"input-1 max-w-xs py-1",type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s)},null,512),[[w,m.value]])]),t("div",W,[t("button",{onClick:e[2]||(e[2]=s=>v()),type:"button",class:"btn-2"},e[6]||(e[6]=[t("i",{class:"fas fa-search"},null,-1),t("span",{class:"hidden lg:inline"},"ফলাফল দেখান",-1)]))])])]),t("div",X,[t("table",Z,[e[9]||(e[9]=t("thead",null,[t("tr",{class:"bg-gray-200 text-left text-gray-700 text-sm tracking-wider"},[t("th",{class:"px-4 py-3 border border-gray-200"},"#"),t("th",{class:"px-4 py-3 border border-gray-200"},"কাস্টমার"),t("th",{class:"px-4 py-3 border text-center"},"ধরন"),t("th",{class:"px-4 py-3 border text-center"},"মোট"),t("th",{class:"px-4 py-3 border text-center"},"ছাড়"),t("th",{class:"px-4 py-3 border text-center"},"বাট্টা"),t("th",{class:"px-4 py-3 border text-center"},"পরিশোধ"),t("th",{class:"px-4 py-3 border text-center"},"বাকী"),t("th",{class:"px-4 py-3 border text-center"},"অবস্থা"),t("th",{class:"px-4 py-3 border text-center"},"তারিখ"),t("th",{class:"px-4 py-3 border text-center"},"একশন")])],-1)),t("tbody",null,[b.value?(r(),n("tr",tt,[t("td",et,[f(E,{class:"shadow-none"})])])):L.value.length===0?(r(),n("tr",st,e[7]||(e[7]=[t("td",{colspan:"11",class:"text-center py-6 text-gray-500"},"No orders found",-1)]))):(r(!0),n(j,{key:2},A(L.value,s=>{var N;return r(),n("tr",{key:s.id,class:"hover:bg-gray-50 transition ease-in-out"},[t("td",ot,a(s.id),1),t("td",at,a((N=s==null?void 0:s.user)==null?void 0:N.name),1),t("td",lt,a(s.type),1),t("td",nt,a(s.total_price),1),t("td",rt,[t("p",dt," ("+a(s.discount_percentage)+"%) "+a(s.discount_amount),1)]),t("td",ut,a(s.adjust_amount),1),t("td",ct,a(s.paid_amount),1),t("td",it,[t("p",null,a(s.due_amount),1),s.due_amount>0?(r(),n("button",{key:0,class:"btn-link text-red-600 text-sm",onClick:Dt=>P(s)}," বাকী আদায় ",8,pt)):g("",!0)]),t("td",mt,a(s.status),1),t("td",yt,[t("p",xt,a(new Date(s.created_at).toLocaleString("bn-BD")),1)]),t("td",bt,[t("div",_t,[f(d,{to:{name:"OrderDetails",params:{id:s.id}},class:"btn-icon"},{default:$(()=>e[8]||(e[8]=[t("i",{class:"fas fa-eye"},null,-1)])),_:2},1032,["to"])])])])}),128))])])]),x.value?(r(),n("div",vt,a(x.value),1)):g("",!0)]),_.value?(r(),n("div",gt,[t("div",ft,[e[14]||(e[14]=t("h2",{class:"text-lg font-bold mb-4"},"Collect Payment",-1)),t("p",null,[e[10]||(e[10]=t("strong",null,"অর্ডার নং:",-1)),k(" "+a((i=l.value)==null?void 0:i.id),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"ক্রেতা:",-1)),k(" "+a((V=(y=l.value)==null?void 0:y.user)==null?void 0:V.name),1)]),t("p",null,[e[12]||(e[12]=t("strong",null,"বাকী:",-1)),k(" ৳"+a((O=l.value)==null?void 0:O.due_amount),1)]),t("div",ht,[e[13]||(e[13]=t("label",{for:"payment-amount",class:"block text-sm font-medium"},"পরিশোধ যোগ্য",-1)),h(t("input",{id:"payment-amount",type:"number",class:"w-full p-2 border rounded mt-1","onUpdate:modelValue":e[3]||(e[3]=s=>c.value=s),min:1,max:(F=l.value)==null?void 0:F.due_amount},null,8,wt),[[w,c.value]])]),t("div",{class:"flex justify-center mt-6 space-x-2"},[t("button",{class:"btn-3",onClick:M},"Cancel"),t("button",{class:"btn-2",onClick:R},"Submit")])])])):g("",!0)],64)}}};export{Ot as default};
