import{d as F,L as A}from"./index-Ck0kI_ww.js";import{_ as B}from"./PhotoModal-DatCINX3.js";import{r,k as D,f as V,c as n,b as e,e as c,a as M,w as m,p as O,F as _,h as L,t as l,o as d,q as f}from"./vue-D0mF8XVW.js";import"./vendor-BtuGy7By.js";const U={class:"my-container space-y-4"},E={class:"flex items-center justify-between gap-2"},R={class:"overflow-x-auto bg-white shadow rounded-lg"},T={class:"table-auto w-full border-collapse border border-gray-200"},$={key:0},q={colspan:"6"},z={key:1},G={class:"px-4 py-3 border border-gray-200 min-w-max"},H={class:"flex justify-center md:justify-start min-w-max"},I=["onClick","src"],J={class:"px-4 py-3 border border-gray-200"},K={class:"md:flex gap-2 text-sm"},Q={class:"font-medium inline-flex flex-wrap gap-x-1"},W={class:"font-medium inline-flex flex-wrap gap-x-1"},X={class:"px-4 py-3 border border-gray-200"},Y={class:"min-w-max"},Z={class:"px-4 py-3 border border-gray-200"},ee={class:"px-4 py-3 border border-gray-200"},te={class:"min-w-max"},se={class:"px-4 py-3 border border-gray-200"},oe={class:"flex justify-center gap-4"},ae={key:0,class:"mt-4 text-red-600 text-sm text-center"},ce={__name:"ProductList",setup(le){const u=F(),y=r(null),b=r(null),h=r(!0),x=r(!1),v=r(null),p=r(null),g=r(!1),w=r(!1);D(async()=>{var o,t;try{await u.fetchProducts()}catch(i){y.value=((t=(o=i.response)==null?void 0:o.data)==null?void 0:t.message)||"Failed to fetch products"}finally{h.value=!1}});const P=V(()=>Array.isArray(u.products)?[...u.products].sort((o,t)=>new Date(t.created_at)-new Date(o.created_at)):[]),N=o=>{b.value=o,v.value=o.photo,x.value=!0},k=()=>{x.value=!1,p.value=null},j=o=>{p.value=o},C=async()=>{if(!(!p.value||!b.value))try{g.value=!0,await u.uploadPhoto(b.value.id,p.value),await u.fetchProducts(),w.value=!0,setTimeout(()=>{k(),g.value=!1,w.value=!1},1500)}catch(o){console.error("Failed to upload photo:",o)}finally{g.value=!1}};return(o,t)=>{const i=O("RouterLink");return d(),n(_,null,[e("div",U,[e("div",E,[t[1]||(t[1]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"পণ্য তালিকা",-1)),c(i,{to:{name:"ProductAdd"},class:"btn-2"},{default:m(()=>t[0]||(t[0]=[e("span",{class:"hidden md:flex"},"নতুন বই",-1),e("i",{class:"far fa-plus"},null,-1)])),_:1})]),e("div",R,[e("table",T,[t[10]||(t[10]=e("thead",null,[e("tr",{class:"bg-gray-200 text-left text-gray-700 uppercase text-sm tracking-wider"},[e("th",{class:"px-4 py-3 border border-gray-200"},"ছবি"),e("th",{class:"px-4 py-3 border border-gray-200"},"পণ্যের নাম ও দাম"),e("th",{class:"px-4 py-3 border border-gray-200"},"লেখক/অনুবাদক"),e("th",{class:"px-4 py-3 border border-gray-200"},"ক্যাটাগরি"),e("th",{class:"px-4 py-3 border border-gray-200 text-center"},"স্টক"),e("th",{class:"px-4 py-3 border border-gray-200 text-center"},"একশন")])],-1)),e("tbody",null,[h.value?(d(),n("tr",$,[e("td",q,[c(A,{class:"shadow-none"})])])):P.value.length===0?(d(),n("tr",z,t[2]||(t[2]=[e("td",{colspan:"6",class:"text-center py-6 text-gray-500"}," কোন প্রডাক্ট পাওয়া যায়নি। ",-1)]))):(d(!0),n(_,{key:2},L(P.value,s=>{var S;return d(),n("tr",{key:s.id,class:"hover:bg-gray-50 transition ease-in-out"},[e("td",G,[e("div",H,[e("img",{onClick:a=>N(s),src:s.photo,alt:"Photo",class:"w-12 aspect-[3/4] rounded object-cover cursor-pointer"},null,8,I)])]),e("td",J,[c(i,{to:{name:"ProductShow",params:{id:s.id}},class:"title-md line-clamp-1",title:s.name},{default:m(()=>[f(l(s.name),1)]),_:2},1032,["to","title"]),e("div",K,[e("p",Q,[t[3]||(t[3]=e("b",null,"খুচরা মূল্য:",-1)),e("span",null,l(Number(s.mrp).toLocaleString("bn-BD"))+" টাকা",1)]),e("p",W,[t[4]||(t[4]=e("b",null,"বিক্রয় মূল্য:",-1)),e("span",null,l(Number(s.selling_price).toLocaleString("bn-BD"))+" টাকা",1)])])]),e("td",X,[e("div",Y,[e("p",null,[t[5]||(t[5]=e("strong",null,"প্রকাশক:",-1)),f(" "+l(((S=s==null?void 0:s.publisher)==null?void 0:S.name)||"N/A"),1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"লেখক:",-1)),f(" "+l(s.authors.filter(a=>a.role==="author").map(a=>a.name).join(", ")||"N/A"),1)]),e("p",null,[t[7]||(t[7]=e("strong",null,"অনুবাদক:",-1)),f(" "+l(s.authors.filter(a=>a.role==="translator").map(a=>a.name).join(", ")||"N/A"),1)])])]),e("td",Z,[e("div",null,[(d(!0),n(_,null,L(s.categories,a=>(d(),n("p",{key:a,class:"min-w-max"},l(a),1))),128))])]),e("td",ee,[e("p",te,l(Number(s.available_stock).toLocaleString("bn-BD"))+" টি ",1)]),e("td",se,[e("div",oe,[c(i,{to:{name:"ProductShow",params:{id:s.id}},class:"btn-icon"},{default:m(()=>t[8]||(t[8]=[e("i",{class:"fad fa-eye"},null,-1)])),_:2},1032,["to"]),c(i,{to:{name:"ProductEdit",params:{id:s.id}},class:"btn-icon"},{default:m(()=>t[9]||(t[9]=[e("i",{class:"fad fa-edit"},null,-1)])),_:2},1032,["to"])])])])}),128))])])]),y.value?(d(),n("div",ae,l(y.value),1)):M("",!0)]),c(B,{imageSrc:v.value,isOpen:x.value,onClose:k,onFileSelected:j,onUploadPhoto:C},null,8,["imageSrc","isOpen"])],64)}}};export{ce as default};
