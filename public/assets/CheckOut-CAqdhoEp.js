import{d as S,r as c,k as _,m as w,o as p,c as v,a as e,l as f,K as k,F as C,h as V,t as y,u as x,f as q,s as h,e as O,J as U,i as M}from"./vue-yak9Aluo.js";import{b as D,a as $,u as A}from"./index-C9qZyAe9.js";import{u as F}from"./delivery-charge-uKoLZDMC.js";import{u as j}from"./order-aNRLs2Jb.js";import"./vendor-upsvKRUO.js";const B=S("address",()=>{const g=c([]),b=c([]),d=c([]),n=c(!1),i=c(null);async function m(){n.value=!0,i.value=null;try{const u=await D.get("/divisions");g.value=u.data}catch(u){i.value=u.message||"Failed to fetch divisions"}finally{n.value=!1}}async function l(u=null){n.value=!0,i.value=null;try{const o=await D.get("/districts",{params:{division_id:u}});b.value=o.data}catch(o){i.value=o.message||"Failed to fetch districts"}finally{n.value=!1}}async function r(u=null){n.value=!0,i.value=null;try{const o=await D.get("/areas",{params:{district_id:u}});d.value=o.data}catch(o){i.value=o.message||"Failed to fetch areas"}finally{n.value=!1}}return{divisions:g,districts:b,areas:d,loading:n,error:i,fetchDivisions:m,fetchDistricts:l,fetchAreas:r}}),N={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},P=["value"],E=["disabled"],I=["value"],J=["disabled"],K=["value"],L={__name:"AddressSelection",props:{modelValue:{type:Object,default:()=>({division_id:"",district_id:"",area_id:""})}},emits:["update:modelValue"],setup(g,{emit:b}){const d=g,n=b,i=B(),m=c(d.modelValue.division_id),l=c(d.modelValue.district_id),r=c(d.modelValue.area_id);_(()=>{i.fetchDivisions()}),w([m,l,r],([t,s,a])=>{n("update:modelValue",{division_id:t,district_id:s,area_id:a})});const u=()=>{l.value="",r.value="",i.fetchDistricts(m.value)},o=()=>{r.value="",i.fetchAreas(l.value)};return(t,s)=>(p(),v("div",N,[e("div",null,[s[4]||(s[4]=e("label",{for:"division",class:"block text-sm font-medium"},"বিভাগ",-1)),f(e("select",{id:"division","onUpdate:modelValue":s[0]||(s[0]=a=>m.value=a),onChange:u,class:"input-1"},[s[3]||(s[3]=e("option",{value:"",disabled:""},"বিভাগ নির্বাচন করুন",-1)),(p(!0),v(C,null,V(x(i).divisions,a=>(p(),v("option",{key:a.id,value:a.id},y(a.name),9,P))),128))],544),[[k,m.value]])]),e("div",null,[s[6]||(s[6]=e("label",{for:"district",class:"block text-sm font-medium"},"জেলা",-1)),f(e("select",{id:"district","onUpdate:modelValue":s[1]||(s[1]=a=>l.value=a),onChange:o,disabled:!m.value,class:"input-1 disabled:cursor-not-allowed"},[s[5]||(s[5]=e("option",{value:"",disabled:""},"জেলা নির্বাচন করুন",-1)),(p(!0),v(C,null,V(x(i).districts,a=>(p(),v("option",{key:a.id,value:a.id},y(a.name),9,I))),128))],40,E),[[k,l.value]])]),e("div",null,[s[8]||(s[8]=e("label",{for:"area",class:"block text-sm font-medium"},"এলাকা",-1)),f(e("select",{id:"area","onUpdate:modelValue":s[2]||(s[2]=a=>r.value=a),disabled:!l.value,class:"input-1 disabled:cursor-not-allowed"},[s[7]||(s[7]=e("option",{value:"",disabled:""},"এলাকা নির্বাচন করুন",-1)),(p(!0),v(C,null,V(x(i).areas,a=>(p(),v("option",{key:a.id,value:a.id},y(a.name),9,K))),128))],8,J),[[k,r.value]])])]))}},R={class:"my-container space-y-6 py-6"},T={class:"md:col-span-4 space-y-4"},Y={class:"card-bg p-4 space-y-2"},z={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},G={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},H={class:"card-bg p-4"},Q={class:"md:col-span-2 space-y-4"},W={class:"md:col-span-2 card-bg p-4"},X={class:"flex justify-between"},Z={class:"flex justify-between font-bold"},ie={__name:"CheckOut",setup(g){const b=M(),d=$(),n=A(),i=F(),m=j(),l=c({user_id:"",name:"",phone:"",addressData:{division_id:"",district_id:"",area_id:""},address:"",alt_phone:"",delivery_charge:0,payment_method:"Cash"});_(()=>{const o=n.user;o&&(l.value.user_id=o.id,l.value.name=o.name||"",l.value.phone=o.phone||""),i.fetchDeliveryCharge()});const r=q(()=>Number(l.value.addressData.district_id)===47?i.insideCity:i.outsideCity),u=async()=>{if(!l.value.user_id||!l.value.name||!l.value.phone||!l.value.address){alert("Please fill all required fields.");return}if(!l.value.addressData.area_id){alert("Please select an area.");return}l.value.delivery_charge=r.value;const o=d.cartItems.map(s=>({product_id:s.id,quantity:s.quantity,price:s.selling_price}));if(o.length===0){alert("Your cart is empty.");return}const t={...l.value,products:o};try{await m.onlineOrder(t),alert("Order placed successfully!"),d.clearCart(),b.push({name:"MyOrders"})}catch{alert("Failed to place order.")}};return(o,t)=>(p(),v("div",R,[t[19]||(t[19]=e("h1",{class:"title-lg"},"অর্ডার নিশ্চিত করুন",-1)),e("form",{onSubmit:U(u,["prevent"]),class:"grid grid-cols-1 gap-4 md:grid-cols-6"},[e("div",T,[e("div",Y,[t[10]||(t[10]=e("h2",{class:"title-md text-center"},"কুরিয়ার ঠিকানা",-1)),e("div",z,[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium"},"নাম",-1)),f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.name=s),type:"text",class:"input-1",placeholder:"Enter your name",required:""},null,512),[[h,l.value.name]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium"},"ফোন",-1)),f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.phone=s),type:"text",class:"input-1",placeholder:"Enter your phone number",required:""},null,512),[[h,l.value.phone]])])]),O(L,{modelValue:l.value.addressData,"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.addressData=s)},null,8,["modelValue"]),e("div",G,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium"},"ফ্লাট নং, বাসা নং, রোড, গ্রাম/মহল্লা",-1)),f(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>l.value.address=s),class:"input-1",placeholder:"ফ্লাট নং, বাসা নং, রোড, গ্রাম",required:""},null,512),[[h,l.value.address]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium"},"বিকল্প ফোন",-1)),f(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=s=>l.value.alt_phone=s),class:"input-1",placeholder:"বিকল্প ফোন"},null,512),[[h,l.value.alt_phone]])])])]),e("div",H,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium"},"Payment Method",-1)),f(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.payment_method=s),class:"input-1"},t[11]||(t[11]=[e("option",{value:"Cash"},"Cash",-1),e("option",{value:"Card"},"Card",-1),e("option",{value:"Mobile Banking"},"Mobile Banking",-1),e("option",{value:"Other"},"Other",-1)]),512),[[k,l.value.payment_method]])])]),e("div",Q,[e("div",W,[t[15]||(t[15]=e("h2",{class:"title-md text-center"},"অর্ডারের বিবরণ",-1)),(p(!0),v(C,null,V(x(d).cartItems,s=>(p(),v("div",{key:s.id,class:"flex justify-between"},[e("span",null,y(s.name)+" (x"+y(s.quantity)+")",1),e("span",null,"৳"+y(s.selling_price*s.quantity),1)]))),128)),t[16]||(t[16]=e("hr",{class:"border border-black"},null,-1)),e("div",X,[t[13]||(t[13]=e("span",null,"কুরিয়ার চার্জ",-1)),e("span",null,"৳"+y(r.value),1)]),t[17]||(t[17]=e("hr",{class:"border border-black"},null,-1)),e("div",Z,[t[14]||(t[14]=e("span",null,"মোট:",-1)),e("span",null," ৳"+y(x(d).cartItems.reduce((s,a)=>s+a.selling_price*a.quantity,0)+Number(r.value)),1)])]),t[18]||(t[18]=e("div",{class:"flex justify-center"},[e("button",{type:"submit",class:"btn-2"},"Place Order")],-1))])],32)]))}};export{ie as default};
