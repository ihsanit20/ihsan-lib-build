import{p as H,r as o,e as J,c as u,a as l,x as K,b as d,v as S,q as N,F as b,s as f,m as g,t as p,i as O,w as Q,k as W,o as a,d as X,L as Y}from"./index-DGUr7KYT.js";import{u as Z}from"./publisher-DO1x7rdV.js";import{u as ee}from"./category-Cv2qScdx.js";import{u as le}from"./author-B79I0YVa.js";const te={class:"my-container space-y-4"},se={class:"flex items-center justify-between gap-2"},ae=["disabled"],ue={key:1,class:"card-bg md:p-8 p-4"},oe={class:"grid grid-cols-2 gap-4"},ne={class:"grid md:grid-cols-2 gap-4"},de=["value"],ie={class:"p-4 border-2 rounded-md"},re={class:"flex flex-wrap gap-2"},ve=["onClick"],me={class:"mt-2 relative"},ce=["value","disabled"],pe={class:"p-4 border-2 rounded-md"},be={class:"flex flex-wrap gap-2"},fe=["onClick"],ge={class:"mt-2 relative"},xe=["value","disabled"],ye={class:"p-4 border-2 rounded-md"},ke={class:"flex flex-wrap gap-2"},he=["onClick"],we={class:"mt-2 relative"},Se=["value","disabled"],Ce={key:0,class:"text-red-500 text-sm"},Pe={class:"flex justify-center"},_e=["disabled"],Be={key:0},Ue={key:1},Fe={__name:"ProductEdit",setup(Ve){const F=X(),T=W(),A=H(),L=Z(),C=ee(),w=le(),q=T.params.id,P=o(""),_=o(""),B=o(""),U=o(""),V=o(""),I=o(""),i=o([]),x=o(null),r=o([]),y=o(null),v=o([]),k=o(null),m=o(!1),h=o(null);J(async()=>{m.value=!0,h.value=null;try{await C.fetchCategories(),await w.fetchAuthors(),await A.fetchProduct(q),await L.fetchPublishers();const s=A.product;P.value=s.name,B.value=s.mrp,U.value=s.selling_price,V.value=s.ISBN,_.value=s.publisher_id??"",I.value=s.description,i.value=s.categories.map(e=>{var t;return(t=C.categories.find(n=>n.name===e))==null?void 0:t.id}).filter(e=>e),r.value=s.authors.filter(e=>e.role==="author").map(e=>e.id),v.value=s.authors.filter(e=>e.role==="translator").map(e=>e.id)}catch(s){h.value=s.message||"Failed to fetch product"}finally{m.value=!1}});const E=()=>{x.value&&!i.value.includes(x.value)&&i.value.push(x.value),x.value=null},$=s=>{i.value=i.value.filter(e=>e!==s)},j=()=>{y.value&&!r.value.includes(y.value)&&r.value.push(y.value),y.value=null},D=s=>{r.value=r.value.filter(e=>e!==s)},R=()=>{k.value&&!v.value.includes(k.value)&&v.value.push(k.value),k.value=null},z=s=>{v.value=v.value.filter(e=>e!==s)},M=async()=>{m.value=!0,h.value=null;try{const s=[...r.value.map(e=>({id:e,role:"author"})),...v.value.map(e=>({id:e,role:"translator"}))];await A.updateProduct(q,{name:P.value,publisher_id:_.value,ISBN:V.value,description:I.value,categories:i.value,authors:s,mrp:B.value,selling_price:U.value}),alert("Product updated successfully!"),F.push({name:"ProductShow",params:{id:q}})}catch(s){h.value=s.message||"Failed to update product"}finally{m.value=!1}},G=()=>{F.go(-1)};return(s,e)=>(a(),u("div",te,[l("div",se,[l("button",{class:"btn-3",onClick:G},e[9]||(e[9]=[l("i",{class:"far fa-arrow-left"},null,-1),l("span",{class:"hidden md:flex"},"Back",-1)])),e[11]||(e[11]=l("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Edit Product",-1)),l("button",{class:"btn-2",onClick:M,disabled:m.value},e[10]||(e[10]=[l("span",{class:"hidden md:flex"},"Update",-1),l("i",{class:"far fa-save"},null,-1)]),8,ae)]),m.value?(a(),K(Y,{key:0})):(a(),u("div",ue,[l("form",{onSubmit:Q(M,["prevent"]),class:"space-y-6"},[l("div",null,[e[12]||(e[12]=l("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"পণ্যের নাম",-1)),d(l("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=t=>P.value=t),type:"text",class:"input-1",required:""},null,512),[[S,P.value]])]),l("div",oe,[l("div",null,[e[13]||(e[13]=l("label",{for:"mrp",class:"block text-sm font-medium text-gray-700"},"মুদ্রিত মূল্য",-1)),d(l("input",{id:"mrp","onUpdate:modelValue":e[1]||(e[1]=t=>B.value=t),type:"number",class:"input-1",required:""},null,512),[[S,B.value]])]),l("div",null,[e[14]||(e[14]=l("label",{for:"sellingPrice",class:"block text-sm font-medium text-gray-700"}," বিক্রয় মূল্য ",-1)),d(l("input",{id:"sellingPrice","onUpdate:modelValue":e[2]||(e[2]=t=>U.value=t),type:"number",class:"input-1",required:""},null,512),[[S,U.value]])])]),l("div",ne,[l("div",null,[e[15]||(e[15]=l("label",{for:"ISBN",class:"block text-sm font-medium text-gray-700"},"ISBN",-1)),d(l("input",{id:"ISBN","onUpdate:modelValue":e[3]||(e[3]=t=>V.value=t),type:"text",class:"input-1"},null,512),[[S,V.value]])]),l("div",null,[e[17]||(e[17]=l("label",{for:"publisherId",class:"block text-sm font-medium text-gray-700"}," Publisher ",-1)),d(l("select",{id:"publisherId","onUpdate:modelValue":e[4]||(e[4]=t=>_.value=t),class:"input-1",required:""},[e[16]||(e[16]=l("option",{value:"",disabled:""},"-- Select Publisher --",-1)),(a(!0),u(b,null,f(g(L).publishers,t=>(a(),u("option",{key:t.id,value:t.id},p(t.name),9,de))),128))],512),[[N,_.value]])])]),l("div",null,[e[18]||(e[18]=l("label",{for:"description",class:"block text-sm font-medium text-gray-700"}," বিস্তারিত বিবরণ ",-1)),d(l("textarea",{id:"description","onUpdate:modelValue":e[5]||(e[5]=t=>I.value=t),rows:"4",class:"input-1"},null,512),[[S,I.value]])]),l("div",null,[e[20]||(e[20]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ক্যাটাগরি",-1)),l("div",ie,[l("div",re,[(a(!0),u(b,null,f(i.value,t=>{var n;return a(),u("div",{key:t,class:"flex items-center bg-blue-100 text-blue-700 px-3 py-1 rounded-full"},[l("span",null,p(((n=g(C).categories.find(c=>c.id===t))==null?void 0:n.name)||"Unknown Category"),1),l("button",{type:"button",onClick:c=>$(t),class:"ml-2 text-blue-500 hover:text-blue-800"}," × ",8,ve)])}),128))]),l("div",me,[d(l("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>x.value=t),onChange:E,class:"input-1"},[e[19]||(e[19]=l("option",{value:"",disabled:""},"- সিলেক্ট ক্যাটাগরি -",-1)),(a(!0),u(b,null,f(g(C).categories,t=>(a(),u("option",{key:t.id,value:t.id,disabled:i.value.includes(t.id)},p(t.name),9,ce))),128))],544),[[N,x.value]])])])]),l("div",null,[e[22]||(e[22]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"লেখক",-1)),l("div",pe,[l("div",be,[(a(!0),u(b,null,f(r.value,t=>{var n;return a(),u("div",{key:t,class:"flex items-center bg-green-100 text-green-700 px-3 py-1 rounded-full"},[l("span",null,p((n=g(w).authors.find(c=>c.id===t))==null?void 0:n.name),1),l("button",{type:"button",onClick:c=>D(t),class:"ml-2 text-green-500 hover:text-green-800"}," × ",8,fe)])}),128))]),l("div",ge,[d(l("select",{"onUpdate:modelValue":e[7]||(e[7]=t=>y.value=t),onChange:j,class:"input-1"},[e[21]||(e[21]=l("option",{value:"",disabled:""},"- সিলেক্ট লেখক -",-1)),(a(!0),u(b,null,f(g(w).authors,t=>(a(),u("option",{key:t.id,value:t.id,disabled:r.value.includes(t.id)},p(t.name),9,xe))),128))],544),[[N,y.value]])])])]),l("div",null,[e[24]||(e[24]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"অনুবাদক",-1)),l("div",ye,[l("div",ke,[(a(!0),u(b,null,f(v.value,t=>{var n;return a(),u("div",{key:t,class:"flex items-center bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full"},[l("span",null,p((n=g(w).authors.find(c=>c.id===t))==null?void 0:n.name),1),l("button",{type:"button",onClick:c=>z(t),class:"ml-2 text-yellow-500 hover:text-yellow-800"}," × ",8,he)])}),128))]),l("div",we,[d(l("select",{"onUpdate:modelValue":e[8]||(e[8]=t=>k.value=t),onChange:R,class:"input-1"},[e[23]||(e[23]=l("option",{value:"",disabled:""},"- সিলেক্ট অনুবাদক -",-1)),(a(!0),u(b,null,f(g(w).authors,t=>(a(),u("option",{key:t.id,value:t.id,disabled:v.value.includes(t.id)},p(t.name),9,Se))),128))],544),[[N,k.value]])])])]),h.value?(a(),u("div",Ce,p(h.value),1)):O("",!0),l("div",Pe,[l("button",{type:"submit",disabled:m.value,class:"btn-2"},[m.value?(a(),u("span",Be,"Loading...")):(a(),u("span",Ue,"Update Product"))],8,_e)])],32)]))]))}};export{Fe as default};
